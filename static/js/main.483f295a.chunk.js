(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{169:function(t,e,n){},170:function(t,e,n){},191:function(t,e,n){"use strict";n.r(e);var i,a,o,l=n(0),c=n.n(l),r=n(57),s=n.n(r),d=(n(169),n(5)),u=n(14),f=(n.p,n(170),n(4)),h=n(13),x=n.n(h),g=n(2),v=n(17),b=n(7),m=n(1),j=function(t){var e=t.processedData,n=void 0===e?[]:e,i=t.scaleX,a=t.scaleY,o=t.color,c=t.gutter,r=void 0===c?2:c,s=Object(l.useRef)(null),d=Object(l.useMemo)((function(){return Math.max(Math.abs(i.range()[1]-i.range()[0])/((null===n||void 0===n?void 0:n.length)||1)-r,1)}),[r,n,i,a]);return Object(l.useEffect)((function(){s.current&&g.h(s.current).selectAll("g.bar").data(n).enter().append("g").classed("bar",!0).selectAll("rect.b").data((function(t){return console.log(t),[t]})).enter().append("rect").classed("b",!0).attr("x",(function(t){return i(new Date(t.date))-d})).attr("y",(function(t){return a(t.value)})).attr("width",d).attr("height",(function(t){return a(a.domain()[1]-t.value)})).attr("fill",o)}),[n,i,a]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("g",{class:"bars",ref:s})})},O=n(28),p=n(62),y=function(t){var e=t.processedData,n=void 0===e?[]:e,i=t.scaleX,a=t.scaleY,o=(t.gutter,t.color),c=void 0===o?"#000":o,r=Object(p.a)(t,["processedData","scaleX","scaleY","gutter","color"]),s=Object(l.useRef)(null);return Object(l.useEffect)((function(){if(s.current){var t=g.h(s.current);console.log(n),t.select("path").datum(n).attr("fill","none").attr("stroke",c).attr("stroke-width",3).attr("d",g.d().x((function(t){return i(new Date(t.date))})).y((function(t){return a(t.value)})))}}),[n]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("g",Object(O.a)(Object(O.a)({class:"line",ref:s},r),{},{children:Object(m.jsx)("path",{})}))})},w=function(t,e){return Object(l.useMemo)((function(){return t.map((function(t,n){return{date:t.date,value:e(t)}}))}),[t,e])},k=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7;return Object(l.useMemo)((function(){return t.map((function(i,a){return i&&e(i)?{date:i.date,value:t.map(e).filter((function(t,e){return a-n<=e&&e<=a})).reduce((function(t,e){return t+e}),0)/(Math.min(n,a)||1)}:void 0})).filter((function(t){return void 0!==t}))}),[t,e,n])},S=n(58),D=n.n(S),M=b.a.div(i||(i=Object(u.a)(["\n  /* padding: 30px; */\n  width: 100%;\n  margin-top: 10px;\n  /* height: 50vh; */\n  flex: 1;\n  position: relative;\n  transition: all 0.2s;\n"]))),F=b.a.div(a||(a=Object(u.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n\n  .axis line, .axis path {\n    stroke: white;\n  }\n\n  .axis text {\n    fill: white;\n    font-size: 12px;\n    font-family: 'Mitr', sans-serif;\n  }\n\n  text {\n    fill: #7F353E;\n  }\n\n  text.text-white {\n    fill: #fff;\n  }\n  \n  .y-axis-deaths {\n    opacity: 0.3;\n\n    path {\n      opacity: 0;\n    }\n  }\n\n  .y-axis {\n    opacity: 0.4;\n\n    path {\n      opacity: 0;\n    }\n  }\n\n  .shadow {\n    filter: drop-shadow( 0px 8px 8px rgba(0, 0, 0, .2));\n    /* Similar syntax to box-shadow */\n  }\n\n  .x-axis text { opacity: 0; }\n  .x-axis-deaths text { opacity: 0; }\n"]))),z=function(t){var e,n,i,a,o,c,r,s,d,u,h,x,b,O,p,S,z,A,W,B,C,_,T,E,P=t.processedData,R=(t.datesRange,t.padding),I=void 0===R?{top:0,right:0,bottom:12,left:40}:R,X=(t.breakPoint,Object(l.useRef)(null)),L=Object(l.useRef)(null),Y=(Object(l.useRef)(null),640),J=640,N=32,V=240,H=160,G=576,K=160,q=120,Z=I,Q=Object(v.a)({onResize:function(t){var e=t.observe,n=t.unobserve;t.width,t.height,t.entry;n(),e()}}),U=Q.observe,$=(Q.unobserve,Q.w,Q.h,Q.entry,Object(l.useMemo)((function(){var t=P[P.length-1],e=f.DateTime.fromISO(null===t||void 0===t?void 0:t.date),n=e.weekday;return{iso:null===t||void 0===t?void 0:t.date,dateStr:"".concat(e.get("day")," ").concat(["","\u0e21.\u0e04.","\u0e01.\u0e1e.","\u0e21\u0e35.\u0e04.","\u0e40\u0e21.\u0e22.","\u0e1e.\u0e04.","\u0e21\u0e34.\u0e22.","\u0e01.\u0e04.","\u0e2a.\u0e04.","\u0e01.\u0e22.","\u0e15.\u0e04.","\u0e1e.\u0e22.","\u0e18.\u0e04. "][e.get("month")]," ").concat((e.get("year")+543)%100),dayColor:["#C33646","#D5A21F","#C55A9A","#2B9649","#D5682A","#31A0C3","#7E48A4","#C33646"][n],weekdayStr:["\u0e2d\u0e32\u0e17\u0e34\u0e15\u0e22\u0e4c","\u0e08\u0e31\u0e19\u0e17\u0e23\u0e4c","\u0e2d\u0e31\u0e07\u0e04\u0e32\u0e23","\u0e1e\u0e38\u0e18","\u0e1e\u0e24\u0e2b\u0e31\u0e2a","\u0e28\u0e38\u0e01\u0e23\u0e4c","\u0e40\u0e2a\u0e32\u0e23\u0e4c","\u0e2d\u0e32\u0e17\u0e34\u0e15\u0e22\u0e4c"][n],weekdayNum:n}}),[P])),tt=k(P,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_cases)&&void 0!==e?e:0})),et=w(P,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_cases)&&void 0!==e?e:0})),nt=(w(P,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.thailand)||void 0===n?void 0:n.NewConfirmed)&&void 0!==e?e:0})),w(P,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_death)&&void 0!==e?e:0}))),it=k(P,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_death)&&void 0!==e?e:0})),at=Object(l.useMemo)((function(){return Y-I.left-I.right}),[Y,I]),ot=Object(l.useMemo)((function(){return J-I.top-I.bottom}),[J,I]),lt=Object(l.useMemo)((function(){return g.g().domain(g.c(P,(function(t){return new Date(t.date)}))).range([0,384-Z.left-Z.right])}),[P,at]),ct=Object(l.useMemo)((function(){return g.f().domain([0,g.e(P,(function(t){var e,n;return null!==(e=+(null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_cases))&&void 0!==e?e:0}))]).range([208-Z.top-Z.bottom,0])}),[P,ot]),rt=Object(l.useMemo)((function(){return g.f().domain([0,g.e(P,(function(t){var e,n;return null!==(e=+(null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_death))&&void 0!==e?e:0}))]).range([128-Z.top-Z.bottom,0])}),[P,ot]);Object(l.useEffect)((function(){if(X.current){var t=g.h(X.current);t.select("g.chart").attr("transform","translate(".concat(208+Z.left,",").concat(136+Z.top,")")),console.log(P),t.select("g.x-axis").attr("transform","translate(0,".concat(208-Z.bottom,")")).call(g.a(lt).tickValues(lt.domain()).tickFormat((function(t){return f.DateTime.fromJSDate(t).toISODate()})).tickSize(0).tickPadding(8)),t.select("g.y-axis").call(g.b(ct).ticks(7).tickPadding(8).tickSize(-(384-I.left))),t.select("g.chart-death").attr("transform","translate(".concat(208+Z.left,",").concat(400+Z.top,")")),t.select("g.x-axis-deaths").attr("transform","translate(0,".concat(128-Z.bottom,")")).call(g.a(lt).tickValues(lt.domain()).tickFormat((function(t){return f.DateTime.fromJSDate(t).toISODate()})).tickSize(0).tickPadding(8)),t.select("g.y-axis-deaths").call(g.b(rt).ticks(5).tickPadding(8).tickSize(-(384-I.left)))}}),[P]);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(M,{children:Object(m.jsx)(F,{ref:U,children:Object(m.jsx)("div",{id:"container",style:{textAlign:"left",display:"inline-block"},children:Object(m.jsxs)("svg",{id:"chart",className:"d3-component",width:Y,height:J,ref:X,style:{backgroundColor:"#F3E1E3"},children:[Object(m.jsx)("text",{x:N,y:N,fontSize:24,dominantBaseline:"hanging",fontFamily:"Mitr",fontWeight:"600",children:"\u0e2a\u0e16\u0e32\u0e19\u0e01\u0e32\u0e23\u0e13\u0e4c COVID-19 \u0e43\u0e19"}),Object(m.jsx)("text",{x:N,y:52,fontSize:39,dominantBaseline:"hanging",fontFamily:"Mitr",fontWeight:"600",children:"\u0e01\u0e23\u0e38\u0e07\u0e40\u0e17\u0e1e\u0e21\u0e2b\u0e32\u0e19\u0e04\u0e23"}),Object(m.jsx)("rect",{x:448,y:N,width:160,height:64,rx:16,fill:$.dayColor}),Object(m.jsxs)("text",{x:528,y:42,dominantBaseline:"hanging",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"400",fontSize:16,class:"text-white",children:["\u0e1b\u0e23\u0e30\u0e08\u0e33\u0e27\u0e31\u0e19 ",$.weekdayStr," \u0e17\u0e35\u0e48"]}),Object(m.jsx)("text",{x:528,y:60,dominantBaseline:"hanging",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"600",fontSize:24,class:"text-white",children:$.dateStr}),Object(m.jsxs)("g",{transform:"translate(".concat(N,",").concat(q,")"),children:[Object(m.jsx)("rect",{width:G,height:V,rx:16,fill:"#C33646",class:"shadow"}),Object(m.jsx)("rect",{width:K,height:V,rx:16,fill:"#0002"}),Object(m.jsxs)("g",{transform:"translate(".concat(80,",").concat(120,")"),children:[Object(m.jsx)("text",{y:-36,dominantBaseline:"middle",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"400",fontSize:16,class:"text-white",children:"\u0e1c\u0e39\u0e49\u0e15\u0e34\u0e14\u0e40\u0e0a\u0e37\u0e49\u0e2d\u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e27\u0e31\u0e19\u0e19\u0e35\u0e49"}),Object(m.jsxs)("text",{y:0,dominantBaseline:"middle",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"600",fontSize:48,class:"text-white",children:["+",null===P||void 0===P||null===(e=P[P.length-1])||void 0===e||null===(n=e.bangkok)||void 0===n||null===(i=n.new_cases)||void 0===i||null===(a=i.toLocaleString)||void 0===a?void 0:a.call(i)]})]}),Object(m.jsxs)("text",{x:80,y:224,dominantBaseline:"baseline",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"400",fontSize:16,class:"text-white",children:["\u0e2a\u0e30\u0e2a\u0e21 ",null===P||void 0===P||null===(o=P[P.length-1])||void 0===o||null===(c=o.bangkok)||void 0===c||null===(r=c.accumulated_cases)||void 0===r||null===(s=r.toLocaleString)||void 0===s?void 0:s.call(r)]}),Object(m.jsx)("text",{x:176+I.left,y:224-I.bottom+6,dominantBaseline:"hanging",textAnchor:"start",fontFamily:"Mitr",fontWeight:"400",fontSize:12,class:"text-white",children:null===P||void 0===P||null===(d=P[0])||void 0===d?void 0:d.date}),Object(m.jsx)("text",{x:560-I.right,y:224-I.bottom+6,dominantBaseline:"hanging",textAnchor:"end",fontFamily:"Mitr",fontWeight:"400",fontSize:12,class:"text-white",children:null===P||void 0===P||null===(u=P[(null===P||void 0===P?void 0:P.length)-1])||void 0===u?void 0:u.date})]}),Object(m.jsxs)("g",{class:"chart",children:[Object(m.jsx)("g",{class:"x-axis axis"}),Object(m.jsx)("g",{class:"y-axis axis"}),Object(m.jsx)(j,{processedData:et,color:"#fff6",scaleX:lt,scaleY:ct}),Object(m.jsx)(y,{processedData:tt,color:"#fff",scaleX:lt,scaleY:ct})]}),Object(m.jsxs)("g",{transform:"translate(".concat(N,",").concat(384,")"),children:[Object(m.jsx)("rect",{width:G,height:H,rx:16,fill:"#333031",class:"shadow"}),Object(m.jsx)("rect",{width:K,height:H,rx:16,fill:"#fff1"}),Object(m.jsxs)("g",{transform:"translate(".concat(80,",").concat(72,")"),children:[Object(m.jsx)("text",{y:-36,dominantBaseline:"middle",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"400",fontSize:16,class:"text-white",children:"\u0e1c\u0e39\u0e49\u0e40\u0e2a\u0e35\u0e22\u0e0a\u0e35\u0e27\u0e34\u0e15\u0e22\u0e37\u0e19\u0e22\u0e31\u0e19\u0e27\u0e31\u0e19\u0e19\u0e35\u0e49"}),Object(m.jsxs)("text",{y:0,dominantBaseline:"middle",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"600",fontSize:48,class:"text-white",children:["+",null===P||void 0===P||null===(h=P[P.length-1])||void 0===h||null===(x=h.bangkok)||void 0===x||null===(b=x.new_death)||void 0===b||null===(O=b.toLocaleString)||void 0===O?void 0:O.call(b)]}),Object(m.jsxs)("text",{y:36,dominantBaseline:"middle",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"400",fontSize:16,class:"text-white",children:["\u0e1b\u0e23\u0e34\u0e21\u0e13\u0e11\u0e25 +",null===P||void 0===P||null===(p=P[P.length-1])||void 0===p||null===(S=p.bangkok)||void 0===S||null===(z=S.new_death_outskirt)||void 0===z||null===(A=z.toLocaleString)||void 0===A?void 0:A.call(z)]})]}),Object(m.jsxs)("text",{x:80,y:144,dominantBaseline:"baseline",textAnchor:"middle",fontFamily:"Mitr",fontWeight:"400",fontSize:16,class:"text-white",children:["\u0e2a\u0e30\u0e2a\u0e21 ",null===P||void 0===P||null===(W=P[P.length-1])||void 0===W||null===(B=W.bangkok)||void 0===B||null===(C=B.accumulated_death)||void 0===C||null===(_=C.toLocaleString)||void 0===_?void 0:_.call(C)]}),Object(m.jsx)("text",{x:176+I.left,y:144-I.bottom+6,dominantBaseline:"hanging",textAnchor:"start",fontFamily:"Mitr",fontWeight:"400",fontSize:12,class:"text-white",children:null===P||void 0===P||null===(T=P[0])||void 0===T?void 0:T.date}),Object(m.jsx)("text",{x:560-I.right,y:144-I.bottom+6,dominantBaseline:"hanging",textAnchor:"end",fontFamily:"Mitr",fontWeight:"400",fontSize:12,class:"text-white",children:null===P||void 0===P||null===(E=P[(null===P||void 0===P?void 0:P.length)-1])||void 0===E?void 0:E.date})]}),Object(m.jsxs)("g",{class:"chart-death",children:[Object(m.jsx)("g",{class:"x-axis-deaths axis"}),Object(m.jsx)("g",{class:"y-axis-deaths axis"}),Object(m.jsx)(j,{processedData:nt,color:"#fff6",scaleX:lt,scaleY:rt}),Object(m.jsx)(y,{processedData:it,color:"#fff",scaleX:lt,scaleY:rt})]}),Object(m.jsx)("text",{x:N,y:588,dominantBaseline:"bottom",fontFamily:"Mitr",fontWeight:"400",fontSize:16,fill:"#222",children:"\u0e23\u0e27\u0e1a\u0e23\u0e27\u0e21\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e08\u0e32\u0e01 \u0e28\u0e1a\u0e04. \u0e41\u0e25\u0e30 bangkok.go.th/covid19"}),Object(m.jsx)("text",{x:N,y:608,dominantBaseline:"bottom",fontFamily:"Mitr",fontWeight:"400",fontSize:16,fill:"#222",children:"\u0e14\u0e39\u0e01\u0e23\u0e32\u0e1f\u0e41\u0e25\u0e30\u0e44\u0e1f\u0e25\u0e4c\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e44\u0e14\u0e49\u0e17\u0e35\u0e48 taepras.com/bkkcovid19"})]})})})}),Object(m.jsx)("canvas",{id:"canvas",ref:L,width:Y,height:J}),Object(m.jsx)("button",{onClick:function(){console.log(X.current);var t=document.getElementById("container");console.log(t.offsetHeight,t.offsetWidth),D.a.toPng(t,{height:2*t.offsetHeight,width:2*t.offsetWidth,style:{transform:"scale(".concat(2,") translate(").concat(t.offsetWidth/2/2,"px, ").concat(t.offsetHeight/2/2,"px)")}}).then((function(t){var e=document.createElement("a");e.download="my-image-name.png",e.href=t,e.click()})).catch((function(t){return console.error(t)}))},children:"Download PNG"})]})},A=n(30),W=n.n(A),B=b.a.div(o||(o=Object(u.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  padding: 30px;\n"])));var C=function(){var t=Object(l.useState)(),e=Object(d.a)(t,2),n=e[0],i=e[1],a=Object(l.useState)(),o=Object(d.a)(a,2),c=o[0],r=o[1],s=Object(l.useState)(f.DateTime.now().minus({months:2}).startOf("day")),u=Object(d.a)(s,2),h=u[0],g=u[1],v=Object(l.useState)(f.DateTime.now().startOf("day")),b=Object(d.a)(v,2),j=b[0],O=b[1],p=Object(l.useMemo)((function(){for(var t=[],e=h;e<=j;)t.push(e.toISODate()),e=e.plus({days:1});return t}),[h,j]);Object(l.useEffect)((function(){W.a.get("https://covid19.th-stat.com/api/open/timeline").then((function(t){console.log(t.data),i(t.data)})),W.a.get("https://docs.google.com/spreadsheets/d/e/2PACX-1vR5KEVlTJbefwhG7GXg5swMW1rDSctbXuwZR-omHnxdet_DReCYnu0r_CVgzLTxwPqKlz4WMvKOppv1/pub?gid=0&single=true&output=csv").then((function(t){var e=x.a.parse(t.data,{header:!0,dynamicTyping:!0});console.log("gsheets",e);var n=f.DateTime.fromISO(e.data[e.data.length-1].date);O(n),g(n.minus({months:2}).startOf("day")),r(e)}))}),[]);var y=Object(l.useMemo)((function(){if(!n||!c)return[];var t=n.Data.filter((function(t){var e=f.DateTime.fromJSDate(new Date(t.Date));return e>=h.startOf("day")&&e<=j.endOf("day")})),e=c.data.filter((function(t){var e=f.DateTime.fromISO(t.date);return e>=h.startOf("day")&&e<=j.endOf("day")})),i=p.map((function(n){var i,a,o,l;return{date:n,thailand:null!==(i=null===t||void 0===t||null===(a=t.filter((function(t){return e=t.Date,"".concat(e.substr(6,4),"-").concat(e.substr(0,2),"-").concat(e.substr(3,2))===n;var e})))||void 0===a?void 0:a[0])&&void 0!==i?i:{},bangkok:null!==(o=null===e||void 0===e||null===(l=e.filter((function(t){return t.date===n})))||void 0===l?void 0:l[0])&&void 0!==o?o:{}}}));return console.log("gs",e,i),i}),[n,c,h,j,p]);return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(B,{children:Object(m.jsx)(z,{datesRange:p,processedData:y})})})},_=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,192)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,o=e.getLCP,l=e.getTTFB;n(t),i(t),a(t),o(t),l(t)}))};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(C,{})}),document.getElementById("root")),_()}},[[191,1,2]]]);
//# sourceMappingURL=main.483f295a.chunk.js.map