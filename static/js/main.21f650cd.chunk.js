(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{168:function(t,e,n){},169:function(t,e,n){},190:function(t,e,n){"use strict";n.r(e);var a,r,c,o=n(0),i=n.n(o),s=n(57),l=n.n(s),u=(n(168),n(5)),d=n(14),f=(n.p,n(169),n(4)),b=n(13),v=n.n(b),j=n(2),h=n(17),g=n(7),O=n(1),p=function(t){var e=t.processedData,n=void 0===e?[]:e,a=t.scaleX,r=t.scaleY,c=t.color,i=t.gutter,s=void 0===i?2:i,l=Object(o.useRef)(null),u=Object(o.useMemo)((function(){return Math.max(Math.abs(a.range()[1]-a.range()[0])/((null===n||void 0===n?void 0:n.length)||1)-s,1)}),[s,n,a,r]);return Object(o.useEffect)((function(){l.current&&j.h(l.current).selectAll("g.bar").data(n).enter().append("g").classed("bar",!0).selectAll("rect.b").data((function(t){return console.log(t),[t]})).enter().append("rect").classed("b",!0).attr("x",(function(t){return a(new Date(t.date))})).attr("y",(function(t){return r(t.value)})).attr("width",u).attr("height",(function(t){return r(r.domain()[1]-t.value)})).attr("fill",c)}),[n,a,r]),Object(O.jsx)(O.Fragment,{children:Object(O.jsx)("g",{class:"bars",ref:l})})},m=n(28),x=n(61),D=function(t){var e=t.processedData,n=void 0===e?[]:e,a=t.scaleX,r=t.scaleY,c=(t.gutter,t.color),i=void 0===c?"#000":c,s=Object(x.a)(t,["processedData","scaleX","scaleY","gutter","color"]),l=Object(o.useRef)(null);return Object(o.useEffect)((function(){if(l.current){var t=j.h(l.current);console.log(n),t.select("path").datum(n).attr("fill","none").attr("stroke",i).attr("stroke-width",3).attr("d",j.d().x((function(t){return a(new Date(t.date))})).y((function(t){return r(t.value)})))}}),[n]),Object(O.jsx)(O.Fragment,{children:Object(O.jsx)("g",Object(m.a)(Object(m.a)({class:"line",ref:l},s),{},{children:Object(O.jsx)("path",{})}))})},w=function(t,e){return Object(o.useMemo)((function(){return t.map((function(t,n){return{date:t.date,value:e(t)}}))}),[t,e])},k=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7;return Object(o.useMemo)((function(){return t.map((function(a,r){return a&&e(a)?{date:a.date,value:t.map(e).filter((function(t,e){return r-n<=e&&e<=r})).reduce((function(t,e){return t+e}),0)/(Math.min(n,r)||1)}:void 0})).filter((function(t){return void 0!==t}))}),[t,e,n])},y=g.a.div(a||(a=Object(d.a)(["\n  /* padding: 30px; */\n  width: 100%;\n  margin-top: 10px;\n  /* height: 50vh; */\n  flex: 1;\n  position: relative;\n  transition: all 0.2s;\n"]))),M=g.a.div(r||(r=Object(d.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n"]))),S=function(t){var e=t.processedData,n=(t.datesRange,t.padding),a=void 0===n?{top:0,right:0,bottom:20,left:40}:n,r=t.breakPoint,c=void 0===r?.7:r,i=Object(o.useRef)(null),s=Object(h.a)({onResize:function(t){var e=t.observe,n=t.unobserve;t.width,t.height,t.entry;n(),e()}}),l=s.observe,u=(s.unobserve,s.width),d=s.height,b=(s.entry,k(e,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_cases)&&void 0!==e?e:0}))),v=w(e,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_cases)&&void 0!==e?e:0})),g=w(e,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.thailand)||void 0===n?void 0:n.NewConfirmed)&&void 0!==e?e:0})),m=w(e,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_death)&&void 0!==e?e:0})),x=k(e,(function(t){var e,n;return null!==(e=null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_death)&&void 0!==e?e:0})),S=Object(o.useMemo)((function(){return u-a.left-a.right}),[u,a]),T=Object(o.useMemo)((function(){return d-a.top-a.bottom}),[d,a]),X=Object(o.useMemo)((function(){return j.g().domain(j.c(e,(function(t){return new Date(t.date)}))).range([0,S])}),[e,S]),F=Object(o.useMemo)((function(){return j.f().domain([0,j.e(e,(function(t){var e,n;return null!==(e=+(null===t||void 0===t||null===(n=t.thailand)||void 0===n?void 0:n.NewConfirmed))&&void 0!==e?e:0}))]).range([T*c,0])}),[e,T]),R=Object(o.useMemo)((function(){return j.f().domain([0,j.e(e,(function(t){var e,n;return null!==(e=+(null===t||void 0===t||null===(n=t.bangkok)||void 0===n?void 0:n.new_death))&&void 0!==e?e:0}))]).range([T*(1-c)-50,0])}),[e,T]);return Object(o.useEffect)((function(){if(i.current){var t=j.h(i.current);t.select("g.chart").attr("transform","translate(".concat(a.left,",").concat(a.top,")")),console.log(e),t.select("g.x-axis").attr("transform","translate(0,".concat(T*c,")")).call(j.a(X).tickValues(X.domain()).tickFormat((function(t){return f.DateTime.fromJSDate(t).toISODate()}))),t.select("g.y-axis").call(j.b(F)),t.select("g.chart-death").attr("transform","translate(".concat(a.left,",").concat(a.top+T*c+50,")")),t.select("g.x-axis-deaths").attr("transform","translate(0,".concat(T*(1-c)-50,")")).call(j.a(X).tickValues(X.domain()).tickFormat((function(t){return f.DateTime.fromJSDate(t).toISODate()}))),t.select("g.y-axis-deaths").call(j.b(R))}}),[e]),Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(y,{children:Object(O.jsx)(M,{ref:l,children:Object(O.jsxs)("svg",{id:"chart",className:"d3-component",width:u,height:d,ref:i,children:[Object(O.jsxs)("g",{class:"chart",children:[Object(O.jsx)(p,{processedData:g,color:"#fdd",scaleX:X,scaleY:F}),Object(O.jsx)(p,{processedData:v,color:"#faa",scaleX:X,scaleY:F}),Object(O.jsx)(D,{processedData:b,color:"#f00",scaleX:X,scaleY:F}),Object(O.jsx)("g",{class:"x-axis"}),Object(O.jsx)("g",{class:"y-axis"})]}),Object(O.jsxs)("g",{class:"chart-death",children:[Object(O.jsx)(p,{processedData:m,color:"#bbb",scaleX:X,scaleY:R}),Object(O.jsx)(D,{processedData:x,color:"#222",scaleX:X,scaleY:R}),Object(O.jsx)("g",{class:"x-axis-deaths"}),Object(O.jsx)("g",{class:"y-axis-deaths"})]})]})})})})},T=n(30),X=n.n(T),F=g.a.div(c||(c=Object(d.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  padding: 30px;\n"])));var R=function(){var t=Object(o.useState)(),e=Object(u.a)(t,2),n=e[0],a=e[1],r=Object(o.useState)(),c=Object(u.a)(r,2),i=c[0],s=c[1],l=Object(o.useState)(f.DateTime.now().minus({days:60}).startOf("day")),d=Object(u.a)(l,2),b=d[0],j=(d[1],Object(o.useState)(f.DateTime.now().startOf("day"))),h=Object(u.a)(j,2),g=h[0],p=(h[1],Object(o.useMemo)((function(){for(var t=[],e=b;e<=g;)e=e.plus({days:1}),t.push(e.toISODate());return t}),[b,g]));Object(o.useEffect)((function(){X.a.get("https://covid19.th-stat.com/api/open/timeline").then((function(t){console.log(t.data),a(t.data)})),X.a.get("https://docs.google.com/spreadsheets/d/e/2PACX-1vR5KEVlTJbefwhG7GXg5swMW1rDSctbXuwZR-omHnxdet_DReCYnu0r_CVgzLTxwPqKlz4WMvKOppv1/pub?gid=0&single=true&output=csv").then((function(t){var e=v.a.parse(t.data,{header:!0,dynamicTyping:!0});console.log("gsheets",e),s(e)}))}),[]);var m=Object(o.useMemo)((function(){if(!n||!i)return[];var t=n.Data.filter((function(t){var e=f.DateTime.fromJSDate(new Date(t.Date));return e>=b.startOf("day")&&e<=g.endOf("day")})),e=i.data.filter((function(t){var e=f.DateTime.fromISO(t.date);return e>=b.startOf("day")&&e<=g.endOf("day")})),a=p.map((function(n){var a,r,c,o;return{date:n,thailand:null!==(a=null===t||void 0===t||null===(r=t.filter((function(t){return e=t.Date,"".concat(e.substr(6,4),"-").concat(e.substr(0,2),"-").concat(e.substr(3,2))===n;var e})))||void 0===r?void 0:r[0])&&void 0!==a?a:{},bangkok:null!==(c=null===e||void 0===e||null===(o=e.filter((function(t){return t.date===n})))||void 0===o?void 0:o[0])&&void 0!==c?c:{}}}));return console.log("gs",e),a}),[n,i,b,g,p]);return Object(O.jsx)("div",{className:"App",children:Object(O.jsxs)(F,{children:[Object(O.jsx)("h1",{children:"\u0e2a\u0e16\u0e32\u0e19\u0e01\u0e32\u0e23\u0e13\u0e4c\u0e42\u0e04\u0e27\u0e34\u0e14\u0e43\u0e19 \u0e01\u0e17\u0e21."}),Object(O.jsx)(S,{datesRange:p,processedData:m})]})})},Y=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,191)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),a(t),r(t),c(t),o(t)}))};l.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(R,{})}),document.getElementById("root")),Y()}},[[190,1,2]]]);
//# sourceMappingURL=main.21f650cd.chunk.js.map